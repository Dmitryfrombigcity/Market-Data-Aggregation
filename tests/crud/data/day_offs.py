import datetime
from decimal import Decimal

data_without_day_offs = (
    ("2024-06-10", "MOEX", 247.41, 2998),
    ("2024-06-10", "SBER", 317.28, 3006),
    ("2024-06-11", "MOEX", 251.94, 2998),
    ("2024-06-11", "SBER", 317.8, 3006),
    ("2024-06-13", "MOEX", 249.46, 2998),
    ("2024-06-13", "SBER", 317.71, 3006),
    ("2024-06-14", "MOEX", 240.1, 2998),
    ("2024-06-14", "SBER", 319.35, 3006),
    ("2024-06-17", "SBER", 317.65, 3006),
    ("2024-06-17", "MOEX", 235.5, 2998),
    ("2024-06-18", "SBER", 314.34, 3006),
    ("2024-06-18", "MOEX", 230.1, 2998),
    ("2024-06-19", "MOEX", 229.81, 2998),
    ("2024-06-19", "SBER", 310.7, 3006),
    ("2024-06-20", "MOEX", 231.21, 2998),
    ("2024-06-20", "SBER", 314.15, 3006),
    ("2024-06-21", "SBER", 314.14, 3006),
    ("2024-06-21", "MOEX", 225, 2998),
    ("2024-06-24", "SBER", 317.25, 3006),
    ("2024-06-24", "MOEX", 220.19, 2998),
    ("2024-06-25", "SBER", 319.8, 3006),
    ("2024-06-25", "MOEX", 226.19, 2998),
    ("2024-06-26", "SBER", 324.55, 3006),
    ("2024-06-26", "MOEX", 228.28, 2998),
    ("2024-06-27", "MOEX", 228.3, 2998),
    ("2024-06-27", "SBER", 327.16, 3006),
    ("2024-06-28", "SBER", 327.15, 3006),
    ("2024-06-28", "MOEX", 229.1, 2998)
)

data_with_day_offs = [
    (datetime.date(2024, 6, 10), 'SBER', Decimal('317.28'), 3006),
    (datetime.date(2024, 6, 10), 'MOEX', Decimal('247.41'), 2998),
    (datetime.date(2024, 6, 11), 'SBER', Decimal('317.8'), 3006),
    (datetime.date(2024, 6, 11), 'MOEX', Decimal('251.94'), 2998),
    (datetime.date(2024, 6, 12), 'day_off', None, None),
    (datetime.date(2024, 6, 13), 'SBER', Decimal('317.71'), 3006),
    (datetime.date(2024, 6, 13), 'MOEX', Decimal('249.46'), 2998),
    (datetime.date(2024, 6, 14), 'SBER', Decimal('319.35'), 3006),
    (datetime.date(2024, 6, 14), 'MOEX', Decimal('240.1'), 2998),
    (datetime.date(2024, 6, 15), 'day_off', None, None),
    (datetime.date(2024, 6, 16), 'day_off', None, None),
    (datetime.date(2024, 6, 17), 'SBER', Decimal('317.65'), 3006),
    (datetime.date(2024, 6, 17), 'MOEX', Decimal('235.5'), 2998),
    (datetime.date(2024, 6, 18), 'SBER', Decimal('314.34'), 3006),
    (datetime.date(2024, 6, 18), 'MOEX', Decimal('230.1'), 2998),
    (datetime.date(2024, 6, 19), 'SBER', Decimal('310.7'), 3006),
    (datetime.date(2024, 6, 19), 'MOEX', Decimal('229.81'), 2998),
    (datetime.date(2024, 6, 20), 'SBER', Decimal('314.15'), 3006),
    (datetime.date(2024, 6, 20), 'MOEX', Decimal('231.21'), 2998),
    (datetime.date(2024, 6, 21), 'SBER', Decimal('314.14'), 3006),
    (datetime.date(2024, 6, 21), 'MOEX', Decimal('225'), 2998),
    (datetime.date(2024, 6, 22), 'day_off', None, None),
    (datetime.date(2024, 6, 23), 'day_off', None, None),
    (datetime.date(2024, 6, 24), 'SBER', Decimal('317.25'), 3006),
    (datetime.date(2024, 6, 24), 'MOEX', Decimal('220.19'), 2998),
    (datetime.date(2024, 6, 25), 'SBER', Decimal('319.8'), 3006),
    (datetime.date(2024, 6, 25), 'MOEX', Decimal('226.19'), 2998),
    (datetime.date(2024, 6, 26), 'SBER', Decimal('324.55'), 3006),
    (datetime.date(2024, 6, 26), 'MOEX', Decimal('228.28'), 2998),
    (datetime.date(2024, 6, 27), 'SBER', Decimal('327.16'), 3006),
    (datetime.date(2024, 6, 27), 'MOEX', Decimal('228.3'), 2998),
    (datetime.date(2024, 6, 28), 'SBER', Decimal('327.15'), 3006),
    (datetime.date(2024, 6, 28), 'MOEX', Decimal('229.1'), 2998)
]

final_data = [
    (1, datetime.date(2024, 6, 10), 'MOEX', Decimal('0'), 0, Decimal('0.00'), Decimal('247.41'), Decimal('0')),
    (2, datetime.date(2024, 6, 11), 'MOEX', Decimal('500'), 1, Decimal('251.94'), Decimal('251.94'), Decimal('248.06')),
    (3, datetime.date(2024, 6, 13), 'MOEX', Decimal('500'), 1, Decimal('249.46'), Decimal('249.46'), Decimal('248.06')),
    (4, datetime.date(2024, 6, 14), 'MOEX', Decimal('500'), 1, Decimal('240.1'), Decimal('240.1'), Decimal('248.06')),
    (5, datetime.date(2024, 6, 17), 'MOEX', Decimal('500'), 2, Decimal('471.0'), Decimal('235.5'), Decimal('29.91')),
    (6, datetime.date(2024, 6, 18), 'MOEX', Decimal('500'), 2, Decimal('460.2'), Decimal('230.1'), Decimal('29.91')),
    (7, datetime.date(2024, 6, 19), 'MOEX', Decimal('500'), 2, Decimal('459.62'), Decimal('229.81'), Decimal('29.91')),
    (8, datetime.date(2024, 6, 20), 'MOEX', Decimal('500'), 2, Decimal('462.42'), Decimal('231.21'), Decimal('29.91')),
    (9, datetime.date(2024, 6, 21), 'MOEX', Decimal('500'), 2, Decimal('450'), Decimal('225'), Decimal('29.91')),
    (10, datetime.date(2024, 6, 24), 'MOEX', Decimal('500'), 2, Decimal('440.38'), Decimal('220.19'), Decimal('29.91')),
    (11, datetime.date(2024, 6, 25), 'MOEX', Decimal('500'), 2, Decimal('452.38'), Decimal('226.19'), Decimal('29.91')),
    (12, datetime.date(2024, 6, 26), 'MOEX', Decimal('500'), 2, Decimal('456.56'), Decimal('228.28'), Decimal('29.91')),
    (13, datetime.date(2024, 6, 27), 'MOEX', Decimal('500'), 2, Decimal('456.6'), Decimal('228.3'), Decimal('29.91')),
    (14, datetime.date(2024, 6, 28), 'MOEX', Decimal('500'), 2, Decimal('458.2'), Decimal('229.1'), Decimal('29.91'))
]
